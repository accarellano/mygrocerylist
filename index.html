<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Grocery List</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* === (Styles remain unchanged from your version, except note column removed) === */
    :root {
      --bg: #ffffff;
      --text: #000000;
      --card: #f9f9f9;
      --border: #ccc;
      --highlight: #dcbca7;
    }
    body.dark {
      --bg: #121212;
      --text: #f0f0f0;
      --card: #1e1e1e;
      --border: #444;
      --highlight: #f89b86;
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: Arial, sans-serif;
      padding: 10px;
    }
    h2 {
      text-align: center;
      cursor: pointer;
      display: inline-block;
      margin: 0;
    }
    #titleWrapper {
      text-align: center;
      margin-bottom: 10px;
    }
    #titleColor {
      border: none;
      background: transparent;
      cursor: pointer;
      vertical-align: middle;
      width: 20px;
      height: 20px;
    }
    .top-row {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 5px;
    }
    .field {
      display: flex;
      align-items: center;
      gap: 5px;
      margin-bottom: 5px;
    }
    .field input[type="date"],
    .field input[type="number"] {
      font-size: 0.9em;
      padding: 4px;
    }
    #budgetRow {
      margin-bottom: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 10px;
    }
    th, td {
      border: 1px solid var(--border);
      padding: 8px;
      text-align: center;
      vertical-align: top;
    }
    th {
      background-color: var(--card);
    }
    input, select, textarea {
      width: 100%;
      padding: 5px;
      box-sizing: border-box;
      background: var(--card);
      color: var(--text);
      border: 1px solid var(--border);
    }
    button {
      padding: 10px;
      margin-top: 10px;
      width: 100%;
      background-color: #008b98;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1em;
      cursor: pointer;
    }
    .summary {
      font-weight: bold;
      text-align: center;
      margin: 8px 0;
    }
    .red { color: red; }
    .blue { color: blue; }
    .yellow { color: goldenrod; }
    textarea {
      margin-top: 10px;
      height: 60px;
    }
    .footer {
      text-align: center;
      margin-top: 20px;
      font-size: 0.9em;
      color: var(--border);
    }
    .actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .actions button {
      flex: 1;
      min-width: 120px;
    }
    .switch-container {
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
      margin-top: 10px;
    }
    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0; left: 0;
      right: 0; bottom: 0;
      background-color: #ccc;
      transition: 0.4s;
      border-radius: 24px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 18px; width: 18px;
      left: 3px; bottom: 3px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #008b98;
    }
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    @media (max-width: 600px) {
      .top-row {
        flex-direction: column;
        align-items: flex-start;
      }
      .top-row .field {
        width: 100%;
      }
      th, td {
        font-size: 0.8em;
      }
      button {
        font-size: 0.9em;
      }
    }
    .remove-btn {
      background-color: #e0e0e0;
      color: #000000;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      padding: 5px 10px;
    }
    .remove-btn:hover {
      background-color: #cccccc;
    }
  </style>
</head>
<body>
  <div id="titleWrapper">
    <h2 id="title" onclick="editTitle()" style="color: var(--highlight);">My Grocery List</h2>
    <input type="color" id="titleColor" value="#dcbca7" onchange="changeTitleColor(this.value)" title="Change Title Color"/>
  </div>

  <div class="top-row">
    <div class="field">
      <label for="dateInput">Date:</label>
      <input type="date" id="dateInput" style="max-width: 160px;" />
    </div>
  </div>

  <div class="top-row" id="budgetRow">
    <div class="field" style="flex: 1;">
      <label><strong>Budget Allotted:</strong></label>
      <input type="number" id="budget" placeholder="‚Ç±" />
    </div>
  </div>

  <table id="groceryTable">
    <thead>
      <tr>
        <th>#</th>
        <th>‚úî</th>
        <th>Item</th>
        <th>Budget (‚Ç±)</th>
        <th>Actual (‚Ç±)</th>
        <th>üóë</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button onclick="addItem()">+ Add Item</button>

  <div id="totalAmount" class="summary">Total Actual: <span id="totalValue" class="blue">‚Ç±0.00</span></div>
  <div id="remainingBudget" class="summary">Remaining Budget: <span id="remainingValue" class="blue">‚Ç±0.00</span></div>

  <textarea placeholder="Notes..."></textarea>

  <canvas id="categoryChart" style="max-width: 500px; margin: 20px auto; display: block;"></canvas>

  <div class="actions">
    <button onclick="window.print()">üñ® Export / Print</button>
    <button onclick="share()">üì§ Share</button>
  </div>

  <div class="switch-container">
    <label>üåó Dark Mode</label>
    <label class="switch">
      <input type="checkbox" id="darkToggle" onchange="toggleDarkMode()" />
      <span class="slider"></span>
    </label>
  </div>

  <div class="footer">Created by AC | All rights reserved 2025</div>

  <script>
    const tableBody = document.querySelector("#groceryTable tbody");
    const budgetInput = document.getElementById("budget");
    const totalAmountEl = document.getElementById("totalAmount");
    const remainingBudgetEl = document.getElementById("remainingBudget");
    const dateInput = document.getElementById("dateInput");
    const titleEl = document.getElementById("title");
    let categoryChart;

    function editTitle() {
      const current = titleEl.innerText;
      const newTitle = prompt("Rename your grocery list:", current);
      if (newTitle) titleEl.innerText = newTitle;
    }

    function changeTitleColor(color) {
      titleEl.style.color = color;
    }

    function addItem() {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td></td>
        <td><input type="checkbox" /></td>
        <td>
          <input type="text" placeholder="Item Name" /><br/>
          <select>
            <option value=""></option>
            <option>Produce</option>
            <option>Dairy</option>
            <option>Meat</option>
            <option>Snacks</option>
            <option>Beverages</option>
            <option>Household</option>
            <option>Other</option>
          </select>
        </td>
        <td><input type="number" step="0.01" onchange="calculateTotals(); updateCategoryChart();" /></td>
        <td><input type="number" step="0.01" onchange="calculateTotals(); updateCategoryChart();" /></td>
        <td><button class="remove-btn" onclick="removeItem(this)">‚ùå</button></td>
      `;
      tableBody.appendChild(row);
      updateRowNumbers();
    }

    function removeItem(button) {
      const row = button.closest("tr");
      row.remove();
      updateRowNumbers();
      calculateTotals();
      updateCategoryChart();
    }

    function updateRowNumbers() {
      const rows = tableBody.querySelectorAll("tr");
      rows.forEach((row, index) => {
        row.cells[0].textContent = index + 1;
      });
    }

    function calculateTotals() {
      let total = 0;
      const rows = tableBody.querySelectorAll("tr");

      rows.forEach(row => {
        const actual = row.cells[4].querySelector("input").value;
        total += parseFloat(actual) || 0;
      });

      const budget = parseFloat(budgetInput.value) || 0;
      const remaining = budget - total;

      document.getElementById("totalValue").textContent = `‚Ç±${total.toFixed(2)}`;
      document.getElementById("remainingValue").textContent = `‚Ç±${remaining.toFixed(2)}`;

      ["red", "blue", "yellow"].forEach(c => {
        totalAmountEl.querySelector("span").classList.remove(c);
        remainingBudgetEl.querySelector("span").classList.remove(c);
      });

      if (remaining < 0) {
        totalAmountEl.querySelector("span").classList.add("red");
        remainingBudgetEl.querySelector("span").classList.add("red");
      } else if (remaining > 0) {
        totalAmountEl.querySelector("span").classList.add("blue");
        remainingBudgetEl.querySelector("span").classList.add("blue");
      } else {
        totalAmountEl.querySelector("span").classList.add("yellow");
        remainingBudgetEl.querySelector("span").classList.add("yellow");
      }
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark");
      const isDark = document.body.classList.contains("dark");
      localStorage.setItem("darkMode", isDark);
      document.getElementById("darkToggle").checked = isDark;
    }

    function share() {
      const title = titleEl.innerText;
      const url = window.location.href;

      if (navigator.share) {
        navigator.share({
          title: title,
          text: "Here's my grocery list!",
          url: url,
        }).catch(err => alert("Share failed."));
      } else {
        navigator.clipboard.writeText(url);
        alert("Link copied to clipboard!");
      }
    }

    function updateCategoryChart() {
      const rows = tableBody.querySelectorAll("tr");
      const categoryTotals = {};

      rows.forEach(row => {
        const category = row.querySelector("select").value;
        const actual = parseFloat(row.cells[4].querySelector("input").value) || 0;
        if (category) {
          categoryTotals[category] = (categoryTotals[category] || 0) + actual;
        }
      });

      const data = {
        labels: Object.keys(categoryTotals),
        datasets: [{
          data: Object.values(categoryTotals),
          backgroundColor: [
            "#f8b195", "#f67280", "#c06c84", "#6c5b7b", "#355c7d", "#99b898", "#ff847c"
          ]
        }]
      };

      if (categoryChart) {
        categoryChart.data = data;
        categoryChart.update();
      } else {
        const ctx = document.getElementById("categoryChart").getContext("2d");
        categoryChart = new Chart(ctx, {
          type: 'pie',
          data: data,
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'bottom' },
              title: { display: true, text: 'Spending by Category' }
            }
          }
        });
      }
    }

    if (localStorage.getItem("darkMode") === "true") {
      document.body.classList.add("dark");
      document.getElementById("darkToggle").checked = true;
    }

    for (let i = 0; i < 10; i++) addItem();
    dateInput.valueAsDate = new Date();
  </script>
</body>
</html>
